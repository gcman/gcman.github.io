<!DOCTYPE html>
<html lang="en">
<head>
    <title>    Inspheres and Circumspheres of Simplices - Gautam Manohar
</title>
    <meta charset="utf-8" />
        <meta name="keywords" content="algebra, proof, math" />
        <meta name="category" content="math" />
        <meta name="description" content="Every triangle has an inscribed and circumscribed circle. We extend this to tetrahedra and their higher dimensional analogues, simplices." />
        <meta name="author" content="Gautam Manohar" />
        <meta name="copyright" content="Gautam Manohar" />
        <meta name="date" content="2018-02-17 00:00:00-05:00">
<link rel="stylesheet" href="../theme/css/normalize.min.css" type="text/css" />
  <link rel="stylesheet" href="../theme/css/article.css" type="text/css" />
    <meta name="robots" content="index,follow">
    <link rel="shortcut icon" type="image/png" href="../theme/images/icons/favicon.png">
    <link rel="shortcut icon" type="image/x-icon" href="../favicon.ico">
    <!--[if IE]>
            <script src="https://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

    <!--[if lte IE 7]>
            <link rel="stylesheet" type="text/css" media="all" href="../css/ie.css"/>
            <script src="../js/IE8.js" type="text/javascript"></script><![endif]-->

    <!--[if lt IE 7]>
            <link rel="stylesheet" type="text/css" media="all" href="../css/ie6.css"/><![endif]-->
<style>
  .title .math {
    font-size: 50% !important;
  }
</style>
<script type="text/x-mathjax-config">
  MathJax.Ajax.config.path["mhchem"] =
    "https://cdnjs.cloudflare.com/ajax/libs/mathjax-mhchem/3.3.0";
  MathJax.Hub.Config({
    extensions: ["tex2jax.js","MathMenu.js","MathZoom.js", "fast-preview.js", "AssistiveMML.js", "a11y/accessibility-menu.js"],
    jax: ["input/TeX","output/CommonHTML", "output/PreviewHTML"],
    "CommonHTML": {
      scale: 100,
    },
    tex2jax: {
      inlineMath: [ ['$','$'], ["\\(","\\)"] ],
      displayMath: [ ['$$','$$'], ["\\[","\\]"] ],
      processEscapes: true
    },
    TeX: {
      equationNumbers: {  autoNumber: "all"  },
      extensions: ["[mhchem]/mhchem.js","AMSmath.js","AMSsymbols.js","noErrors.js","noUndefined.js"]
    },
    });
</script>
<script type="text/javascript"
   src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.4/MathJax.js?=config=TeX-AMS_CHTML">
</script>

<div class="invisible">
  \(
  \let\Pr\relax
  \DeclareMathOperator\LCM{LCM}
  \DeclareMathOperator\Pr{P}
  \DeclareMathOperator\arccot{arccot}
  \newcommand{\Mod}[1]{\ (\mathrm{mod}\ #1 )}
  \renewcommand{\vec}[1]{\mathbf{ #1 }}
  \newcommand{\norm}[1]{\left\lVert #1 \right\rVert}
  \newcommand{\abs}[1]{\lvert #1 \rvert}
  \newcommand{\floor}[1]{\left\lfloor #1 \right\rfloor}

  \newcommand{\inn}[1]{\in\left\{ #1 \right\}}
  \newcommand{\ninn}[1]{\not\in\left\{ #1 \right\}}
  \newcommand{\orr}{\qquad&amp;\,\text{or}\qquad}

  \renewcommand\d{\mathop{}\!\mathrm{d}}
  \newcommand{\diff}[2]{\frac{\d #1}{\d #2}}
  \newcommand{\qed}{\begin{equation*}\tag*{$\blacksquare$}\end{equation*}}
  \DeclareMathOperator\G{\Gamma}
  \DeclareMathOperator\I{\mathscr{I}}
  \)
</div></head>
<body>
    <article>
    <header>
      <h1 class="title">
            <a href="../simplex-sphere/" rel="bookmark"
           title="Permalink to Inspheres and Circumspheres of Simplices">Inspheres and Circumspheres of Simplices</a>
      </h1>
      <address class="author">Gautam Manohar</address>
        <div id="textbox">
          <p style="font-weight: bold;" class="alignleft">
            <a href="../category/math/">math</a>&nbsp;
          </p>
            <p class="date aligncenter">17 February 2018</p>
          <p style="font-weight: bold; font-variant: normal;" class="alignright"><a href="../tag/algebra/">#algebra</a> <a href="../tag/proof/">#proof</a> </p>
        </div>
       <div style="clear: both;"></div>â€‹
    </header>

      <p>Every triangle can be circumscribed by a circle, because a circle can always be drawn through three given points, so long as they are not colinear. In fact, every triangle also has a circle that is inscribed in it. These two circles are called the triangle&rsquo;s circumcircle and incircle. Finding these circles for a triangle is simple if the triangle is equilateral, a bit harder if it is right-angled, and a bit harder still if it is not.</p>
<p>What is less well-known is that every tetrahedron also has a circumsphere and insphere. Given four points, such that no three of them are colinear and not all four of them are coplanar, there is a unique sphere that goes through all of them. Finding these spheres for a regular tetrahedron is rather straightforward. In particular, a regular tetrahedron&rsquo;s circumsphere is always three times larger in radius than its insphere. But the analagous problem for an arbitrary, not necessarily regular, tetrahedron is much hairier. I will present a geometric proof for the case of the regular tetrahedron, and then a look into the circumsphere and insphere of arbitrary tetrahedra using techniques from linear algebra. Finally, I will generalize my work to arbitrary simplices (the higher-dimensional analogue of tetrahedra) in arbitrary dimensions.</p>
<h1 id="regular-tetrahedra">Regular Tetrahedra</h1>
<p>We wish to find the ratio between the circumsphere and insphere of a regular tetrahedron. Let <span class="math inline">\(ABCD\)</span> be a regular tetrahedron. Let <span class="math inline">\(O\)</span> be the centroid of <span class="math inline">\(ABCD\)</span>. Then because <span class="math inline">\(ABCD\)</span> is regular, <span class="math inline">\(O\)</span> is the incenter and circumcenter of <span class="math inline">\(ABCD\)</span>. Let <span class="math inline">\(X\)</span> be the centroid of the face opposite <span class="math inline">\(A\)</span>. The volume of <span class="math inline">\(OBCD\)</span> is a quarter that of <span class="math inline">\(ABCD\)</span>, because <span class="math inline">\(ABCD\)</span> is the union of <span class="math inline">\(OABC,OABD,OACD,OBCD\)</span>, and each of those tetrahedra with vertex <span class="math inline">\(O\)</span> is congruent to the others. The volume of a tetrahedron is <span class="math inline">\(\frac{1}{3}bh\)</span>. Since <span class="math inline">\(ABCD\)</span> and <span class="math inline">\(OBCD\)</span> have the same base, triangle <span class="math inline">\(BCD\)</span>, the height <span class="math inline">\(OX\)</span> is one quarter the height <span class="math inline">\(AX\)</span>. But because <span class="math inline">\(AO = AX - OX\)</span>, and <span class="math inline">\(\frac{1}{4}|AX| = |OX|\)</span>, then <span class="math inline">\(|AO| = \frac{3}{4}|AX|\)</span>. Note that <span class="math inline">\(AO\)</span> is the circumradius and <span class="math inline">\(OX\)</span> is the inradius. Thus the ratio of the circumradius to the inradius in a regular tetrahedron is <span class="math inline">\(\frac{|AO|}{|OX|} = 3\)</span>.</p>
<h1 id="irregular-tetrahedra">Irregular Tetrahedra</h1>
<p>We use coordinate geometry and linear algebra to find the inradius and circumradius (and incenter and circumcenter) of a tetrahedron given the coordinates of its vertices. To avoid immense computational tedium, we use programming to numerically solve for the desired ratio.</p>
<h2 id="insphere">Insphere</h2>
<p>Let&rsquo;s first deal with the insphere. Let <span class="math inline">\((a,b,c)\)</span> be the vector that gives the coordinates of the incenter, and let <span class="math inline">\(r\)</span> be the inradius. Let the four vertices of the tetrahedron be given by <span class="math inline">\(\vec{V}_i = (x_i,y_i,z_i)\)</span>, where <span class="math inline">\(i \inn{1,2,3,4}\)</span>. Let <span class="math inline">\(F_1\)</span> be the face with vertices <span class="math inline">\(\vec{V}_1, \vec{V}_2, \vec{V}_3\)</span>. Let <span class="math inline">\(F_2\)</span> be formed by <span class="math inline">\(\vec{V}_1,\vec{V}_2,\vec{V}_4\)</span>, <span class="math inline">\(F_3\)</span> by <span class="math inline">\(\vec{V}_1,\vec{V}_3,\vec{V}_4\)</span>, and <span class="math inline">\(F_4\)</span> by <span class="math inline">\(\vec{V}_2,\vec{V}_3,\vec{V}_4\)</span>. Let <span class="math inline">\(\vec{n}_i\)</span> represent the unit vector pointing out of the tetrahedron and perpendicular to the face <span class="math inline">\(F_i\)</span> of the tetrahedron: that is, the unit outward-facing normal vector to <span class="math inline">\(F_i\)</span>. The defining characteristic of the insphere is that each line from the incenter to the point of tangency on a given face is perpendicular to that face and of equal length to the other such lines. Taking a circular cross-section of the insphere such that the sphere and the circle have the same center and point of tangency to the face, we see that the tangent line to the circle must be at a right angle to the line joining the point of tangency and the center (from a famous theorem about circles). Then we have the condition that <span class="math inline">\((a,b,c) + r\vec{n}_i\)</span> lies on <span class="math inline">\(F_i\)</span>.</p>
<p>Let us deal with <span class="math inline">\(F_1\)</span>. A vector perpendicular to the plane containing two vectors is given by their cross product. We can let these two vectors be two of the edges of <span class="math inline">\(F_1\)</span>. An edge on a face is the displacement between two vertices of a face. Then the cross product <span class="math display">\[\begin{equation}
    (\vec{V}_2 - \vec{V}_1) \times (\vec{V}_3 - \vec{V}_1)
    \label{unscaled-normal}
\end{equation}\]</span> is perpendicular to <span class="math inline">\(F_1\)</span>. But <span class="math inline">\(\eqref{unscaled-normal}\)</span> need not point outward. To remove this ambiguity, we scale <span class="math inline">\(\eqref{unscaled-normal}\)</span> by a negative value if it is pointing inward and by a positive value if it is pointing outward. Consider the dot product of <span class="math inline">\(\eqref{unscaled-normal}\)</span> and the displacement vector <span class="math inline">\(\vec{V}_4 - \vec{V}_1\)</span>, which points from the first vertex away from the outward-facing normal and to the fourth vertex. Thus the angle between the outward-facing normal and this displacement vector is between <span class="math inline">\(\frac{\pi}{2}\)</span> and <span class="math inline">\(\pi\)</span>, so the cosine of the angle is negative, so the dot product of these two vectors is negative. Then scaling <span class="math inline">\(\eqref{unscaled-normal}\)</span> by the negative of the dot product yields an outward-facing normal.<br/>
We then need to normalize this vector to obtain the desired unit outward-facing normal vector <span class="math inline">\(\vec{n}_1\)</span>: <span class="math display">\[\begin{equation}
    \vec{n}_1 = -\frac{(\vec{V}_2 - \vec{V}_1) \times (\vec{V}_3 - \vec{V}_1)(\vec{V}_2 - \vec{V}_1) \times (\vec{V}_3 - \vec{V}_1)\cdot(\vec{V}_4 - \vec{V}_1)}{\norm{(\vec{V}_2 - \vec{V}_1) \times (\vec{V}_3 - \vec{V}_1)(\vec{V}_2 - \vec{V}_1) \times (\vec{V}_3 - \vec{V}_1)\cdot(\vec{V}_4 - \vec{V}_1)}}.
    \label{normalized}
\end{equation}\]</span></p>
<p>The point-normal form for the equation of a plane perpendicular to a vector <span class="math inline">\(\vec{n}\)</span> and which contains a point <span class="math inline">\(P_0\)</span> is, for some point <span class="math inline">\(P\)</span> on the plane, <span class="math display">\[\begin{equation}
    (P - P_0) \cdot \vec{n} = 0.
\end{equation}\]</span> In particular, we want the equation for the plane which contains <span class="math inline">\(F_1\)</span>. We use <span class="math inline">\(P = (a,b,c) + r\vec{n}_1\)</span> (the point on <span class="math inline">\(F_1\)</span> tangent to the insphere) and <span class="math inline">\(P_0 = \vec{V}_1\)</span> (it can be any of the vertices of the face in question, in this case <span class="math inline">\(F_1\)</span>). This gives <span class="math display">\[\begin{equation}
    ((a,b,c) + r\vec{n}_1 - \vec{V}_1) \cdot \vec{n}_1 = 0.
\end{equation}\]</span> Distributing the dot product, we have <span class="math display">\[\begin{equation}
    (a,b,c)\cdot\vec{n}_1 + r\vec{n}_1\cdot\vec{n}_1 - \vec{V}_1\cdot\vec{n}_1 = 0.
\end{equation}\]</span> We then break each vector into its three components: <span class="math display">\[\begin{equation}
    \begin{split}
        a\vec{n}_{1_x} + b\vec{n}_{1_y} + c\vec{n}_{1_z} + r(\vec{n}_{1_x}^2 + \vec{n}_{1_y}^2 + \vec{n}_{1_z}^2) &amp; \\
        \qquad - x_1\vec{n}_{1_x} - y_1\vec{n}_{1_y} - z_1\vec{n}_{1_z} &amp;= 0 \\
        a\vec{n}_{1_x} + b\vec{n}_{1_y} + c\vec{n}_{1_z} + r(\vec{n}_{1_x}^2 + \vec{n}_{1_y}^2 + \vec{n}_{1_z}^2) &amp;= x_1\vec{n}_{1_x} + y_1\vec{n}_{1_y} + z_1\vec{n}_{1_z}.
    \end{split}
\end{equation}\]</span> This equation has four unknowns: the coordinates of the incenter <span class="math inline">\(a,b,c\)</span> and the inradius <span class="math inline">\(r\)</span>. Using the other three faces, we arrive at a system of four equations with four unknowns: <span class="math display">\[\begin{equation}
    \begin{split}
        a\vec{n}_{1_x} + b\vec{n}_{1_y} + c\vec{n}_{1_y} + r(\vec{n}_{1_x}^2 + \vec{n}_{1_y}^2 + \vec{n}_{1_z}^2) &amp;= x_1\vec{n}_{1_x} + y_1\vec{n}_{1_y} + z_1\vec{n}_{1_z} \\
        a\vec{n}_{2_x} + b\vec{n}_{2_y} + c\vec{n}_{2_z} + r(\vec{n}_{2_x}^2 + \vec{n}_{2_y}^2 + \vec{n}_{2_z}^2) &amp;= x_2\vec{n}_{2_x} + y_2\vec{n}_{2_y} + z_2\vec{n}_{2_z} \\
        a\vec{n}_{3_x} + b\vec{n}_{3_y} + c\vec{n}_{3_z} + r(\vec{n}_{3_x}^2 + \vec{n}_{3_y}^2 + \vec{n}_{3_z}^2) &amp;= x_3\vec{n}_{3_x} + y_3\vec{n}_{3_y} + z_3\vec{n}_{3_z} \\
        a\vec{n}_{4_x} + b\vec{n}_{4_y} + c\vec{n}_{4_z} + r(\vec{n}_{4_x}^2 + \vec{n}_{4_y}^2 + \vec{n}_{4_z}^2) &amp;= x_4\vec{n}_{4_x} + y_4\vec{n}_{4_y} + z_4\vec{n}_{4_z}
    \end{split}
\end{equation}\]</span> We can solve this system with matrices. Let <span class="math display">\[\begin{equation}
    \vec{A} =
    \begin{bmatrix}
        \vec{n}_{1_x} &amp; \vec{n}_{1_y} &amp; \vec{n}_{1_y} &amp; \vec{n}_{1_x}^2 + \vec{n}_{1_y}^2 + \vec{n}_{1_z}^2 \\
        \vec{n}_{2_x} &amp; \vec{n}_{2_y} &amp; \vec{n}_{2_y} &amp; \vec{n}_{2_x}^2 + \vec{n}_{2_y}^2 + \vec{n}_{2_z}^2 \\
        \vec{n}_{3_x} &amp; \vec{n}_{3_y} &amp; \vec{n}_{3_y} &amp; \vec{n}_{3_x}^2 + \vec{n}_{3_y}^2 + \vec{n}_{3_z}^2 \\
        \vec{n}_{4_x} &amp; \vec{n}_{4_y} &amp; \vec{n}_{4_y} &amp; \vec{n}_{4_x}^2 + \vec{n}_{4_y}^2 + \vec{n}_{4_z}^2
    \end{bmatrix}
    \label{insphere-A}
\end{equation}\]</span> Let <span class="math display">\[\begin{equation}
    \vec{u} =
    \begin{bmatrix}
        x_1\vec{n}_{1_x} + y_1\vec{n}_{1_y} + z_1\vec{n}_{1_z} \\
        x_2\vec{n}_{2_x} + y_2\vec{n}_{2_y} + z_2\vec{n}_{2_z} \\
        x_3\vec{n}_{3_x} + y_3\vec{n}_{3_y} + z_3\vec{n}_{3_z} \\
        x_4\vec{n}_{4_x} + y_4\vec{n}_{4_y} + z_4\vec{n}_{4_z}
    \end{bmatrix}
    \label{insphere-B}
\end{equation}\]</span> And let the solution vector be <span class="math display">\[\begin{equation}
    \vec{v} =
    \begin{bmatrix}
        a \\
        b \\
        c \\
        r
    \end{bmatrix}
    \label{insphere-sols}
\end{equation}\]</span> Then <span class="math display">\[\begin{equation}
    \begin{split}
        \vec{A}\vec{v} &amp;= \vec{u} \\
        \vec{v} &amp;= \vec{A}^{-1}\vec{u}.
    \end{split}
\end{equation}\]</span> And so the inradius <span class="math inline">\(r\)</span> is the fourth element of <span class="math inline">\(\vec{v}\)</span>, or <span class="math inline">\(\vec{v}_4\)</span>.</p>
<h2 id="circumsphere">Circumsphere</h2>
<p>Now we deal with the circumsphere. Let the circumsphere have center <span class="math inline">\((A,B,C)\)</span> and radius <span class="math inline">\(R\)</span>. It then has the equation <span class="math display">\[\begin{equation}
    (x - A)^2 + (y - B)^2 + (z - C)^2 = R^2
    \label{sphere-eq}
\end{equation}\]</span> All four of a tetrahedron&rsquo;s vertices lie on its circumsphere, and so their coordinates satisfy <span class="math inline">\(\eqref{sphere-eq}\)</span>. We have four vertices with which we can make a system of four equations: <span class="math display">\[\begin{equation}
    \begin{split}
        (x_1 - A)^2 + (y_1 - B)^2 + (z_1 - C)^2 &amp;= R^2 \\
        (x_2 - A)^2 + (y_2 - B)^2 + (z_2 - C)^2 &amp;= R^2 \\ 
        (x_3 - A)^2 + (y_3 - B)^2 + (z_3 - C)^2 &amp;= R^2 \\ 
        (x_4 - A)^2 + (y_4 - B)^2 + (z_4 - C)^2 &amp;= R^2
    \end{split}
    \label{R-system}
\end{equation}\]</span> Subtracting the first equation from each of the other three, we have another system of equations: <span class="math display">\[\begin{equation}
    \begin{split}
        2A(x_1-x_2) + 2B(y_1-y_2) + 2C(z_1-z_2) &amp;= x_1^2 + y_1^2 + z_1^2 - x_2^2 - y_2^2 - z_2^2 \\
        2A(x_1-x_3) + 2B(y_1-y_3) + 2C(z_1-z_3) &amp;= x_1^2 + y_1^2 + z_1^2 - x_3^2 - y_3^2 - z_3^2 \\
        2A(x_1-x_4) + 2B(y_1-y_4) + 2C(z_1-z_4) &amp;= x_1^2 + y_1^2 + z_1^2 - x_4^2 - y_4^2 - z_4^2
    \end{split}
\end{equation}\]</span> We can solve this system of equations using matrices. Let <span class="math display">\[\begin{equation}
    \vec{M} =
    2\begin{bmatrix}
        x_1-x_2 &amp; y_1-y_2 &amp; z_1-z_2 \\
        x_1-x_3 &amp; y_1-y_3 &amp; z_1-z_3 \\
        x_1-x_4 &amp; y_1-y_4 &amp; z_1-z_4
    \end{bmatrix}
    \label{circumsphere-A}
\end{equation}\]</span> Let <span class="math display">\[\begin{equation}
    \vec{u} = 
    \begin{bmatrix}
        x_1^2 + y_1^2 + z_1^2 - x_2^2 - y_2^2 - z_2^2 \\
        x_1^2 + y_1^2 + z_1^2 - x_3^2 - y_3^2 - z_3^2 \\
        x_1^2 + y_1^2 + z_1^2 - x_4^2 - y_4^2 - z_4^2
    \end{bmatrix}
    \label{circumsphere-B}
\end{equation}\]</span> And let the solution vector be <span class="math display">\[\begin{equation}
    \vec{v} =
    \begin{bmatrix}
        A \\
        B \\
        C
    \end{bmatrix}
    \label{circumsphere-sols}
\end{equation}\]</span> Then <span class="math display">\[\begin{equation}
    \vec{v} = \vec{M}^{-1}\vec{u}. 
\end{equation}\]</span> Having solved for <span class="math inline">\(A,B,C\)</span>, we can solve for <span class="math inline">\(R\)</span> from one of the equations in <span class="math inline">\(\eqref{R-system}\)</span>. Let&rsquo;s use the first one. <span class="math display">\[\begin{equation}
    \begin{split}
        R^2 &amp;= (x_1 - A)^2 + (y_1 - B)^2 + (z_1 - C)^2 \\
        R &amp;= \sqrt{(x_1 - A)^2 + (y_1 - B)^2 + (z_1 - C)^2}.
    \end{split}
\end{equation}\]</span></p>
<p>Although we could compute the components of <span class="math inline">\(\vec{n}_i\)</span> by doing long and tedious calculations with cross products, dot products, and norms and invert our matrices using, say, Gaussian elimination, the closed form expressions for the inradius <span class="math inline">\(r\)</span> and the circumradius <span class="math inline">\(R\)</span> would be very unwieldy and so not very useful.</p>
<h1 id="generalizing-to-n-simplices_1">Generalizing to n-Simplices</h1>
<p>Our method generalizes readily to higher dimensions. The dot product generalizes very simply. The one thing we need is a generalization of the cross product, which is only defined in three dimensions&hellip; except we don&rsquo;t. Our only use for the cross product was to find a vector normal to two others. The cross product can be represented as the determinant of a matrix <span class="math display">\[\begin{equation}
    \begin{vmatrix}
        \vec{v}_1^1 &amp; \vec{v}_1^2 &amp; \vec{v}_1^3 \\
        \vec{v}_2^1 &amp; \vec{v}_2^2 &amp; \vec{v}_2^3 \\
        \vec{b}_1 &amp; \vec{b}_2 &amp; \vec{b}_3
    \end{vmatrix}
\end{equation}\]</span> Here the subscript is the index of the vector (out of those we are taking the cross product of) and the superscript is the index of the component in that vector. Each vector <span class="math inline">\(\vec{b}_i\)</span> is the <span class="math inline">\(i\)</span>-th basis vector of our <span class="math inline">\(n\)</span>-dimensional vector space. We can then write our generalized cross product of <span class="math inline">\(n-1\)</span> vectors in <span class="math inline">\(n\)</span>-dimensions as <span class="math display">\[\begin{equation}
    \mathscr{C}(\vec{v}_1,\vec{v}_2,\ldots,\vec{v}_{n-1}) =
    \begin{vmatrix}
        \vec{v}_1^1 &amp; \cdots &amp; \vec{v}_1^{n} \\
        \vdots &amp; \ddots &amp; \vdots \\
        \vec{v}_{n-1}^1 &amp; \cdots &amp; \vec{v}_{n-1}^n \\
        \vec{b}_1 &amp; \cdots &amp; \vec{b}_{n}
    \end{vmatrix}
\end{equation}\]</span> But we can get even simpler. Determinants can get hard to compute as they get large. And because we are only interested in the cross product for its <em>direction</em> (and not its magnitude; we normalize everything later anyway), we can use a simpler method. Any element of the kernel of the <span class="math inline">\(n-1\)</span> by <span class="math inline">\(n\)</span> matrix given by taking the <span class="math inline">\(n-1\)</span> vectors to be rows is in the orthogonal direction to all the given vectors.</p>
<p>An <span class="math inline">\(n\)</span> simplex is given by <span class="math inline">\(n+1\)</span> points, given by the vectors <span class="math inline">\(\vec{V}_i\)</span>, where <span class="math inline">\(i\)</span> is an integer from <span class="math inline">\(1\)</span> to <span class="math inline">\(n+1\)</span>. Each of these vectors has <span class="math inline">\(n\)</span> components, <span class="math inline">\(\vec{V}_i^j\)</span>, where <span class="math inline">\(j\)</span> is an integer from <span class="math inline">\(1\)</span> to <span class="math inline">\(n\)</span>. Each of the <span class="math inline">\(n+1\)</span> faces is a collection of <span class="math inline">\(n\)</span> of the <span class="math inline">\(n+1\)</span> points. Again, let&rsquo;s first deal with the insphere:</p>
<h2 id="insphere-1">Insphere</h2>
<p>Let the vector representing the insphere&rsquo;s coordinates have <span class="math inline">\(n\)</span> components <span class="math inline">\(c_i\)</span>. Imitating <span class="math inline">\(\eqref{normalized}\)</span>, we have <span class="math display">\[\begin{equation} \label{general-insphere}
    \vec{n}_1 = -\frac{\vec{C}(\vec{C}\cdot(\vec{V}_{n+1} - \vec{V}_1))}{\norm{\vec{C}(\vec{C}\cdot(\vec{V}_{n+1} - \vec{V}_1))}},
\end{equation}\]</span> where <span class="math display">\[\begin{equation}
    \vec{C} = \mathscr{C}((\vec{V}_2 - \vec{V}_1)\times(\vec{V}_3 - \vec{V}_1)\times \cdots \times (\vec{V}_{n} - \vec{V}_1)).
\end{equation}\]</span> Then we can use matrices again: <span class="math display">\[\begin{equation} \label{general-insphere-A}
    \vec{A} =
    \begin{bmatrix}
        \vec{n}_i^j &amp; \sum (\vec{n}_i^j)^2
    \end{bmatrix}
\end{equation}\]</span> <span class="math display">\[\begin{equation} \label{general-insphere-B}
    \vec{u} =
    \begin{bmatrix}
        \sum \vec{V}_i^j \vec{n}_i^j
    \end{bmatrix}
\end{equation}\]</span> <span class="math display">\[\begin{equation}
    \vec{s} =
    \begin{bmatrix}
        c_1 \\
        c_2 \\
        \vdots \\
        c_n \\
        r
    \end{bmatrix}
\end{equation}\]</span> Then <span class="math display">\[\begin{equation}
    \vec{A}\vec{s} = \vec{u}.
\end{equation}\]</span></p>
<h2 id="circumsphere-1">Circumsphere</h2>
<p>Let the vector representing the insphere&rsquo;s coordinates have <span class="math inline">\(n\)</span> components <span class="math inline">\(C_i\)</span>. Our procedure for finding the circumsphere generalizes readily as follows. <span class="math display">\[\begin{equation}
    \vec{M} = 2
    \begin{bmatrix}
        \vec{V}_1^1 - \vec{V}_2^1 &amp; \cdots &amp; \vec{V}_1^n - \vec{V}_2^n \\
        \vdots &amp; \ddots &amp; \vdots \\
        \vec{V}_1^1 - \vec{V}_{n+1}^1 &amp; \cdots &amp; \vec{V}_1^n - \vec{V}_{n+1}^n
    \end{bmatrix}
\end{equation}\]</span> <span class="math display">\[\begin{equation}
    \vec{u} = 
    \begin{bmatrix}
        \sum ((v_1^j)^2 - (v_2^j)^2) \\
        \vdots \\
        \sum ((v_1^j)^2 - (v_{n+1}^j)^2) \\
    \end{bmatrix}
\end{equation}\]</span> <span class="math display">\[\begin{equation}
    \vec{s} =
    \begin{bmatrix}
        C_1 \\
        C_2 \\
        \vdots \\
        C_n \\
        r
    \end{bmatrix}
\end{equation}\]</span> Then <span class="math display">\[\begin{equation}
    \vec{A}\vec{s} = \vec{u}.
\end{equation}\]</span></p>
<h2 id="implementing-our-higher-dimensional-processes">Implementing Our Higher Dimensional Processes</h2>
<p>We&rsquo;ll use <code>Python</code> and its <code>numpy</code> package. Let&rsquo;s first set up a function to compute our generalized cross product using the kernel method. Here&rsquo;s a standard implementation of finding the kernel, or nullspace, of a matrix, sourced from <a href="http://scipy-cookbook.readthedocs.io/items/RankNullspace.html">here</a>.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">nullspace</span><span class="p">(</span><span class="n">A</span><span class="p">,</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-13</span><span class="p">,</span> <span class="n">rtol</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">atleast_2d</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">u</span><span class="p">,</span> <span class="n">s</span><span class="p">,</span> <span class="n">vh</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">svd</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>
    <span class="n">tol</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">atol</span><span class="p">,</span> <span class="n">rtol</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">nnz</span> <span class="o">=</span> <span class="p">(</span><span class="n">s</span> <span class="o">&gt;=</span> <span class="n">tol</span><span class="p">)</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span>
    <span class="n">ns</span> <span class="o">=</span> <span class="n">vh</span><span class="p">[</span><span class="n">nnz</span><span class="p">:]</span><span class="o">.</span><span class="n">conj</span><span class="p">()</span><span class="o">.</span><span class="n">T</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">ns</span><span class="p">])</span>
</pre>
</div>
<p>We return the element of the nullspace that is a vector of norm 1 and use it to calculate the generalized cross product.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">gen_cross</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">nullspace</span><span class="p">(</span><span class="n">m</span><span class="p">)</span>
</pre>
</div>
<p>The argument <code>v</code> will always be a list of lists; each element represents a vector. Now we can calculate the incenter and inradius:</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">insphere</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">faces</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="n">normals</span> <span class="o">=</span> <span class="p">[]</span>
</pre>
</div>
<p>Note that <code>n</code> is the &ldquo;dimension&rdquo; of the tetrahedron.</p>
<div class="highlight">
<pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">faces</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span> <span class="o">+</span> <span class="p">[</span><span class="n">v</span><span class="p">[</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]])</span>
        <span class="k">del</span> <span class="n">faces</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">n</span><span class="o">-</span><span class="n">i</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">n</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">faces</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">faces</span><span class="p">))</span>
    <span class="n">faces</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">faces</span><span class="p">)</span>
</pre>
</div>
<p>Each face of an <span class="math inline">\(n\)</span>-simplex consists of some <span class="math inline">\(n\)</span> of the given <span class="math inline">\(n+1\)</span> vertices. Each element of <code>faces</code> has <span class="math inline">\(n+1\)</span> elements: the <span class="math inline">\(n\)</span> vertices of the face, and the other vertex that is not part of the face. The statement involving the modulo ensures that the orientation is correct in even dimensions. Then we can finish it off by performing the calculations in <span class="math inline">\(\eqref{general-insphere}\)</span> and setting up the matrices as in <span class="math inline">\(\eqref{general-insphere-A}\)</span> and <span class="math inline">\(\eqref{general-insphere-B}\)</span>.</p>
<div class="highlight">
<pre><span></span>    <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">faces</span><span class="p">:</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">gen_cross</span><span class="p">([</span><span class="n">f</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="p">)])</span>
        <span class="n">unnormed</span> <span class="o">=</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">c</span><span class="p">,</span> <span class="n">f</span><span class="p">[</span><span class="n">n</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">normals</span><span class="o">.</span><span class="n">append</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">**</span><span class="p">(</span><span class="n">n</span><span class="o">%</span><span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">unnormed</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">unnormed</span><span class="p">))</span>
    <span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="o">+</span> <span class="p">[</span><span class="nb">sum</span><span class="p">([</span><span class="n">k</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])]</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">normals</span><span class="p">])</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">sum</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">*</span><span class="n">normals</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
</pre>
</div>
<p>We go along a similar line for the circumsphere: we set up the matrices and solve.</p>
<div class="highlight">
<pre><span></span><span class="k">def</span> <span class="nf">circumsphere</span><span class="p">(</span><span class="n">v</span><span class="p">):</span>
    <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">v</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span>
    <span class="n">A</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">B</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="nb">sum</span><span class="p">([</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="o">-</span> <span class="n">v</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">n</span><span class="o">+</span><span class="mi">1</span><span class="p">)])</span>
    <span class="n">sols</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="n">B</span><span class="p">)</span>
    <span class="n">R</span> <span class="o">=</span> <span class="n">sqrt</span><span class="p">(</span><span class="nb">sum</span><span class="p">([(</span><span class="n">v</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">sols</span><span class="p">[</span><span class="n">i</span><span class="p">])</span><span class="o">**</span><span class="mi">2</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">n</span><span class="p">)]))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sols</span><span class="p">,</span> <span class="n">R</span><span class="p">)</span>
</pre>
</div>
<p>And there you have it! It would be interesting to see how the ratio between circumsphere and insphere (3 in 3 dimensions) changes as the dimension increases. It will probably get much larger (because most of a high-dimensional sphere&rsquo;s volume is near its surface and because the insphere&rsquo;s volume will become very small), but how quickly?</p>

    <aside id="gcman-toolbar">
                <a title="On the Ball in n Euclidean Dimensions" class="prev" href="../n-ball/">
                    <i class="fas fa-chevron-circle-left"></i>
            </a>
        <a title="Raw source" class="raw" href="../simplex-sphere/src.md" type="text/plain">
            <i class="fas fa-code" aria-hidden="true"></i>
        </a>
<a title="Home" class="home" href="../blog/">
    <i class="fas fa-home"></i>
</a>        <a title="PDF" class="pdf" href="../simplex-sphere/post.pdf">
            <i class="far fa-file-pdf" aria-hidden="true"></i>
        </a>
                <a title="Almost There I" class="next" href="../almost-patterns-sinc/">
                    <i class="fas fa-chevron-circle-right"></i>
            </a>
    </aside>
  </article>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
<script>
  $('.title a').html(function(index, value) {
    return value.replace(/(\d+)/g, '<span style="font-size: 1.5em;">$1</span>');
});
</script>
    <section>
    </section>
    <script defer src="https://use.fontawesome.com/releases/v5.0.6/js/all.js"></script>
</body>
</html>