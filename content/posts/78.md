+++
title = "Project Euler 78: Coin Partitions"
author = ["Gautam Manohar"]
description = "My solution to problem 78 of Project Euler."
date = 2018-07-31
tags = ["proof"]
draft = true
+++

## Problem Statement {#problem-statement}

Let \\(p(n)\\) represent the number of ways \\(n\\) can be written as the sum of
positive integers. For example, \\(p(5) = 7\\). Given \\(N\\), return \\(p(N)\\) modulo
\\(10^9 + 7\\).


## My Algorithm {#my-algorithm}

We cannot use the \\(O(n^2)\\) technique given in [Project Euler 31](../31/). Instead, we will
make use of a wonderful piece of mathematics known as [Euler's pentagonal number
theorem](https://en.wikipedia.org/wiki/Pentagonal%5Fnumber%5Ftheorem). It states that

\begin{equation}
\prod\_{k=1}^\infty (1-x^k) = \sum\_{i \in \mathbb{Z}}(-1)^ix^{g\_i},
\end{equation}

where \\(g\_i\\) is the $i$-th generalized pentagonal number, given by \\(g\_n =
\frac{n(3n-1)}{2}\\) for \\(n = \pm1,\pm2,\pm3,\ldots\\) (note that \\(n\\) is positive
then negative and so on). In other words,

\begin{equation}
(1-x)(1-x^2)(1-x^3) \cdots = 1 - x - x^2 + x^5 + x^7 - x^12 - x^15 + x^22 + \cdots
\end{equation}

To prove this, let's first define the series \\(A\_n\\) as

\begin{equation}
A\_n = 1 - x^{2n - 1} - \sum\_{i=3}^\infty x^{in - 1} \prod\_{j = 0}^{i-3} (1 - x^{n+j}).
\end{equation}

Factoring out an \\(x^{3n-1}\\) term from the last summand gives

\begin{equation}
A\_n = 1 - x^{2n - 1} - x^{3n-1}\sum\_{i=0}^\infty x^{in} \prod\_{j = 0}^{i} (1 - x^{n+j}).
\end{equation}

Let us denote this new series as \\(B\_n\\), such that

\begin{equation}
A\_n = 1 - x^{2n - 1} - x^{3n-1}B\_n.
\end{equation}

Pulling out the \\(i=j=0\\) term from the series \\(B\_n\\) gives

\begin{equation}
\begin{split}
B\_n &= \sum\_{i=0}^\infty x^{in} \prod\_{j = 0}^{i} (1 - x^{n+j}) \\\\\\
&= x^0(1 - x^{n+0}) + \sum\_{i=1}^\infty x^{in} (1-x^n)\prod\_{j = 0}^{i} (1 - x^{n+j}) \\\\\\
&= 1 - x^n + \sum\_{i=1}^\infty x^{in} (1-x^n)\prod\_{j = 1}^{i} (1 - x^{n+j}).
\end{split}
\end{equation}

Distributing the \\(j = 0\\) term we pulled out of the product, we have

\begin{equation}
\begin{split}
B\_n &= 1 - x^n + \sum\_{i=1}^\infty x^{in}\prod\_{j = 1}^{i} (1 - x^{n+j}) - \sum\_{i=1}^\infty x^nx^{in}\prod\_{j = 1}^{i} (1 - x^{n+j}) \\\\\\
B\_n &= 1 - x^n + \sum\_{i=1}^\infty x^{in}\prod\_{j = 1}^{i} (1 - x^{n+j}) - \sum\_{i=1}^\infty x^{(i+1)n}\prod\_{j = 1}^{i} (1 - x^{n+j}) \\\\\\
\end{split}
\end{equation}

It implies that

\begin{equation}
\begin{split}
p(n) &= \sum\_k (-1)^{k-1}p(n-g\_k) \\\\\\
&= p(n-1) + p(n-2) - p(n-5) - p(n-7) + \cdots,
\end{split}
\end{equation}

First, let's look at the generating function for \\(p(n)\\). We have

\begin{equation}
\prod\_{k=1}^\infty \left( \frac{1}{1-x^k} \right) = \sum\_{k=0}^\infty p(k)x^k.
\end{equation}

To see why this is the case, let's expand each term of the product as a
geometric series. It will have first term 1 and common ratio \\(x^k\\). We then have

\begin{equation}
\begin{split}
\prod\_{k=1}^\infty \left( \frac{1}{1-x^k} \right) &= (1 + x + x^2 + x^3 + \cdots)(1 + x^2 + x^4 + x^6 + \cdots)(1 + x^3 + x^6 + x^9 + \cdots)\cdots \\\\\\
&= \prod\_{k=1}^\infty \left( \sum\_{j=0}^\infty x^{kj} \right).
\end{split}
\label{part-form}
\end{equation}

Consider the coefficient on the term \\(x^n\\). To get \\(x^n\\), we take one summand
from each term in the sum. In other words, each term is of the form \\(x^{k\_1 +
2k\_2 + 3k\_3 + \cdots}\\). A combinatorial interpretation is that each coefficient
\\(k\_i\\) represents the number of times \\(i\\) appears in a particular way of writing
\\(n\\) as a sum of natural numbers. This means that the coefficient on \\(x^n\\) is the
number of such ways to write \\(n\\), which is \\(p(n)\\).